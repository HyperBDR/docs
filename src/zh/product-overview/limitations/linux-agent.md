# Linux Agent

## 操作系统兼容性列表

| 操作系统     | 支持版本 |
| -------- | ----------------------------------------------------------------------------- |
| CentOS (64-bit) | 6.x, 7.x, 8.x |
| Red Hat Enterprise Linux (RHEL) (64-bit) | 6.x, 7.x, 8.x |
| SUSE Linux Enterprise Server (SLES) (64-bit) | 11(SP1-SP4), 12(12/SP1-SP5), 15(15/SP1-SP5) |
| Ubuntu Server (64-bit) | 12.04.x, 14.04.x, 16.04.x, 18.04.x, 20.04.x, 22.04.x, 24.04.x |
| Oracle Linux Server (64-bit) | 6.x, 7.x, 8.x |
| Kylin Linux | v10 SP1(v2101) |
| UOS | UOS 1050 u2a, UOS 1050 u2e |
| OpenEuler | 22.03.x, 24.03.x |

::: warning
- 注意：操作系统内核支持范围：2.6.32 ~ 5.8（标准社区版本）
- 目前不支持带有云标签的内核版本。如果需要特定的内核版本支持，请联系技术支持。

关于版本的详细支持情况，请点击[源端操作系统支持矩阵](https://oneprocloud.feishu.cn/sheets/VRqksSPEPhRTPStp3kVcItXNnyh?sheet=Y9fpqO)查看兼容性列表及最新支持状态。
:::

## 支持和限制条件

### 基本要求:
- **CPU:** x86-64位处理器（i386或更高版本）
- **内存:** 每个挂载点大约消耗300MB的缓存空间。例如，如果有3个挂载点，大约需要1000MB内存。
- **磁盘空间:**
  - *软件空间:* 软件安装需至少100MB可用空间。
  - *缓存空间:* 每个文件系统需保留大于10%的可用空间。
- **网络连接:** 至少10Mbps的连接带宽，连接至目标端点。
- **系统固件:** BIOS或UEFI.
- **磁盘布局:** MBR或GPT.
- **虚拟化支持:** 支持完全虚拟化，但对半虚拟化（如XenServer）支持有限，可能在最终启动时需要手动修复。

### 支持和限制条件

| 条件说明         | 支持情况                | 不支持情况                      |
| ---------------- | ----------------------- | ------------------------------- |
| 文件系统类型     | 支持：EXT2、EXT3、EXT4、XFS、FAT、exFAT | 不支持：Btrfs、OracleASM        |
| 分区类型         | 支持：主分区、扩展分区、LVM、MBR、GPT | 不支持：LVM精简逻辑卷、LUKS加密分区 |
| 启动方式         | 支持：grub、grub2        | 不支持：LILO                    |
| 启动磁盘         | 支持：第一块磁盘为启动盘 | 不支持：指定其他磁盘为启动盘     |
| 共享磁盘         | 支持：可迁移，但需手动清理冗余 | 不支持：多路径远程磁盘（FC、IP SAN） |
| 虚拟化类型       | 支持：完全虚拟化         | 半虚拟化（如XenServer，可能需手动修复） |
| 未挂载分区/磁盘  | 不适用                  | 不支持：未挂载的分区和裸磁盘     |
| iSCSI磁盘        | 支持：不修改发起器名称    | 不适用                          |
| 加密磁盘         | 不适用                  | 不支持：LUKS加密磁盘/分区       |
| 网络挂载目录     | 不适用                  | 不支持：NFS/NAS等网络共享挂载目录（需独立同步工具） |
| Oracle RAC 集群     | 不适用                  | 不支持 |

### 系统启动要求
- 支持 grub 和 grub2 启动方法的系统可正常同步并启动
- 不支持 LILO 启动方法的主机驱动修复
- 如果存在单独的 `/boot` 分区，必须在 `/etc/fstab` 中明确定义；否则启动驱动修复时会失败，导致系统启动失败。如该定义缺失，建议手动添加（该分区未在 fstab 表中挂载）
- 主机的第一块磁盘必须是启动磁盘。目前仅部分云平台支持指定系统盘启动

### 磁盘与分区限制
- 当共享磁盘被多个源主机挂载使用时，会根据主机进行迁移，导致该共享磁盘被多次迁移，目标端会出现多个相同的磁盘，需要手动清理冗余磁盘，仅保留一个共享磁盘供多个主机共享
- 不支持多路径远程磁盘（FC、IP SAN）
- 不支持未挂载的分区和磁盘（未挂载到特定目录的裸磁盘）
- 不支持 LUKS 加密磁盘/分区
- 网络共享挂载目录（如 NFS/NAS 远程网络访问数据）需要使用独立的文件级同步工具进行数据同步
- 使用 iSCSI 磁盘时，注意不要修改原始发起器名称，以免影响业务系统
- 不支持 Btrfs 文件系统
- 不支持 OracleASM 磁盘
- 不支持 LVM 精简逻辑卷

## 常见问题

在使用 Linux Agent 之前，请仔细阅读本部分内容，以避免因不兼容场景导致同步失败或对源端应用产生冲突，从而影响系统的稳定运行。

### 应用冲突检查
- 系统中不得存在与Linux Agent相同的组件。

::: warning

在使用 Linux Agent 时，请务必关注业务运行时的内存使用情况。特别是当业务系统通过 `scp`、`rsync` 等方式长时间向主机传输数据，且系统内存使用率持续超过 70% 时，应谨慎启用 Linux Agent。在这种情况下，可能会因内存资源不足触发系统的 Out of Memory（OOM）机制，导致服务中断甚至系统重启，严重影响业务的连续性。

建议在此场景下提前优化系统资源分配，或选择合适的时间窗口运行 Linux Agent，以降低风险。

:::


### 内核升级提醒

::: warning

在实际项目中，我们发现某些 Linux 发行版（例如 Ubuntu）会默认启用自动内核升级。由于 Linux Agent 的运行机制依赖于特定的内核模块，而这些模块必须与安装时的内核版本严格匹配，因此内核升级后，即便重新加载模块，也可能导致同步失败。

为了确保 Linux Agent 的长期稳定运行，建议禁用自动内核升级，并尽量避免跨版本升级（例如从 5.4 直接升级至 5.15），以降低兼容性风险。如果发生了内核升级，则需要手动更新 Linux Agent 及其对应的内核模块，并执行全量同步，以确保数据一致性和系统的正常运行。

:::
